wandb_log: true
wandb_entity: null
wandb_project: null
wandb_key: null
mode: cocomix
seed: 22
rank: 0
suffix: null
base_model: openai-community/gpt2
pretrained_model: openai-community/gpt2
dataset: openwebtext
data_dir: ./data/openwebtext_preprocess
n_embd: 2048
n_layer: 24
n_head: 16
vocab_size: null
load_path: null
port: 9819
distributed: false
world_size: 1
use_torch_compile: false
compile_dynamo_cache_size_limit: 512
lr: 0.0002
lr_schedule: cosine_with_min_lr
beta1: 0.9
beta2: 0.95
grad_clip_thresh: 1.0
warmup_steps: 65
min_lr: 2.0e-05
eps: 1.0e-08
mixed_precision: null
weight_decay: 0.1
train_steps: 20000
n_epochs: 0
num_workers: 2
update_batch_size: 32
grad_acc_steps: 16
block_size: 256
dropout: 0.0
bias: false
log_path: null
use_accelerator: true
save_step_freq: 1000
eval_step_freq: 500
log_step_freq: 50
global_step: 0
val_datasets:
- openwebtext
batch_size_eval: 4
eval_limit: 1000
topK_attri: 4
concept_num: 32
concept_dim: 32768
sae_location: resid_post_mlp
insert_layer_index: 5
sae_layer_index: 5
lam_concept: 0.1
use_grad_checkpoint: true
attn_implementation: flash_attention_2
torch_dtype: float16
